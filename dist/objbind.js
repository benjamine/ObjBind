(function(m){var d=function(){var a=new d.OQArray;a._array=Array.prototype.slice.apply(arguments);return a};d.a=function(){var a;if(arguments.length==1&&arguments[0]instanceof Array)a=arguments[0];else{a=[];for(var b=0;b<arguments.length;b++)arguments[b]instanceof Array&&a.push.apply(a,arguments[b])}b=new d.OQArray;b._array=a;return b};var r=m.$o;m.objBind=m.$o=d;d.noConflict=function(){m.$o=r;return d};d.extendjQuery=function(){if(typeof jQuery=="undefined")return false;jQuery.fn.trackChanges=function(){this.each(function(){if(typeof this==
"object"){d(this).bind("change",null);this.__$o__.jQueryEvents=true}});return this};jQuery.fn.lookupChanges=function(){this.each(function(){typeof this=="object"&&this.__$o__&&this.__$o__.lookup()});return this};return true};d.extendjQuery();d.isDOMObject=function(a){if(typeof a=="undefined"||a===null)return false;if(typeof Node!="undefined"&&a instanceof Node||typeof Element!="undefined"&&a instanceof Element||typeof NodeList!="undefined"&&a instanceof NodeList||a===window||a===document)return true;
if(typeof o==="object"&&typeof o.nodeType==="number"&&typeof o.nodeName==="string")return true;return false};d.propertyInterceptModes={UNKNOWN:0,NONE:1,DEFINESETTER:2,DEFINEPROPERTY:3,DEFINEPROPERTYONLYDOM:4};var j=d.propertyInterceptModes.UNKNOWN;d.propertyInterceptModeName=function(){var a=d.propertyInterceptMode(),b;for(b in d.propertyInterceptModes)if(d.propertyInterceptModes[b]===a)return b;return"UNKNOWN"};d.propertyInterceptMode=function(){if(j===d.propertyInterceptModes.UNKNOWN){var a;if(j===
d.propertyInterceptModes.UNKNOWN){a={};if(typeof a.__defineSetter__=="function")try{a.__defineGetter__("myproperty",function(){return this._myproperty});a.__defineSetter__("myproperty",function(f){this._myproperty=f});a.myproperty="my value";if(a.myproperty==="my value"&&a._myproperty==="my value")j=d.propertyInterceptModes.DEFINESETTER}catch(b){}}if(j===d.propertyInterceptModes.UNKNOWN&&Object.defineProperty){try{a={};Object.defineProperty(a,"myproperty",{get:function(){return this._myproperty},
set:function(f){this._myproperty=f}});a.myproperty="my value";if(a.myproperty==="my value"&&a._myproperty==="my value")j=d.propertyInterceptModes.DEFINEPROPERTY}catch(c){}if(j===d.propertyInterceptModes.UNKNOWN)if(document&&document.createElement){a=document.createElement("span");try{Object.defineProperty(a,"myproperty",{get:function(){return this._myproperty},set:function(f){this._myproperty=f}});a.myproperty="my value";if(a.myproperty==="my value"&&a._myproperty==="my value")j=d.propertyInterceptModes.DEFINEPROPERTYONLYDOM}catch(e){}}}if(j===
d.propertyInterceptModes.UNKNOWN)j=d.propertyInterceptModes.NONE}return j};d.Event=function(a,b,c,e){this.type=a;this.target=b;this.data=c;this.result=e;this.timeStamp=new Date};d.Event.prototype.extend=function(a){for(var b in a)this[b]=a[b];return this};d.Event.prototype.stopImmediatePropagation=function(){this.__propagationStopped__=true};d.Event.prototype.isImmediatePropagationStopped=function(){return!!this.__propagationStopped__};d.Event.prototype.toString=function(){var a=[],b;b=this.type;
var c=function(e){if(e)a.push(b+" "+e.length+" item"+(e.length===1?"":"s")+(this.index!=="undefined"?" at index "+this.index:""))};this.removeItems&&c(this.removeItems);this.addItems&&c(this.addItems);this.undetectedLengthChange&&a.push("undetected array length change");if(a.length===0){b=this.type==="propertyChanging"?"changing":"changed";this.property!=="undefined"&&a.push('property "'+this.property+'" '+b+" from "+this.previousValue+" to "+this.value)}a.length===0&&a.push(this.type);return a.join(", ")};
d.propertyFilter=function(a,b){return b.substr(0,1)!=="_"&&b.substr(0,6)!=="jQuery"&&typeof a[b]!=="function"&&!(this.overrides&&this.overrides[b])};d.OQHelper=function(a){this.obj=a};d.OQHelper.prototype.bind=function(a,b,c){var e=this.events||(this.events={}),f;if(typeof c=="undefined"){c=b;b=null}if(typeof a=="object")f=a;else{f={};f[a]=c}for(var g in f){a=g.split(" ");for(c=0;c<a.length;c++){var h=e[a[c]]||(e[a[c]]=[]);if(this.obj instanceof Array&&(a[c]==="change"||a[c]==="adding"||a[c]==="added"||
a[c]==="removing"||a[c]==="removed"))this.interceptArrayModifiers();else if(a[c]==="change"||a[c]==="propertyChanging"||a[c]==="propertyChanged")this.interceptProperties();if(typeof f[g]!="undefined"){var i=true;if(typeof f[g]!="function")for(var k=h.length-1;k>=0;k--)if(h[k]===f[g])i=false;i&&h.push({data:b,handler:f[g]})}}}return this};d.OQHelper.prototype.unbind=function(a,b){var c=this.events;if(c){if(typeof b=="undefined")if(typeof a==="function"){b=a;a=null}if(typeof a=="string")for(var e=a.split(" "),
f=0;f<e.length;f++){if(e[f]){var g=c[e[f]];if(g)if(b){g.splice(0,g.length);for(var h=0,i=g.length;h<i;h++)if(b===g[h].handler){g.splice(h,1);h--}}else g.splice(0,g.length)}}else if(b)for(e in c){g=c[e];g.splice(0,g.length);h=0;for(i=g.length;h<i;h++)if(b===g[h].handler){g.splice(h,1);h--}}else{this.removeInterceptors();delete this.events}return this}};d.OQHelper.prototype.trigger=function(a){var b=this.events,c;if(b){var e,f,g;if(a instanceof d.Event){e=a;f=[e.type]}else f=a.split(" ");c=Array.prototype.slice.apply(arguments);
if(this.jQueryEvents&&typeof jQuery!="undefined")for(var h=0;h<f.length;h++)try{var i=this.jQueryObj||(this.jQueryObj=jQuery(this.obj));c[0]=e?new jQuery.Event(e.type,e):f[h];i.trigger.apply(i,c)}catch(k){}for(h=0;h<f.length;h++)if(f[h]){i=b[f[h]];var n=false;if(i)for(var p=0,s=i.length;p<s&&!n;p++){var q=i[p].handler;if(typeof q=="function"){if(e){e.target=this.obj;e.result=g;c[0]=e}else c[0]=new d.Event(f[h],this.obj,i[p].data,g);g=q.apply(this.obj,c);n=c[0].isImmediatePropagationStopped()}}}return this}};
d.OQHelper.prototype.removeInterceptors=function(){if(typeof this.obj!="object")return this;if(this._propertiesIntercepted){if(this.overrides)for(var a in this.obj)a.substr(0,1)!=="_"&&!this.overrides[a]&&this.unoverrideProperty(this.obj,a);this._propertiesIntercepted=false}if(this._arrayModifiersIntercepted){if(this.overrides){this.unoverride(this.obj,"push");this.unoverride(this.obj,"pop");this.unoverride(this.obj,"shift");this.unoverride(this.obj,"unshif");this.unoverride(this.obj,"splice")}this._arrayModifiersIntercepted=
false}};d.OQHelper.prototype.unoverride=function(a){if(!this.overrides)return this;var b=this.overrides[a];if(b){this.obj[a]=b.original;delete this.overrides[a]}return this};d.OQHelper.prototype.override=function(a,b){if(!this.overrides)this.overrides={};this.overrides[a]||(this.overrides[a]={original:this.obj[a]});b.overriden=this.obj[a];this.obj[a]=b;return this};d.OQHelper.prototype.overrideProperty=function(a,b,c){var e=d.propertyInterceptMode();if(e===d.propertyInterceptModes.UNKNOWN||e===d.propertyInterceptModes.NONE)return this;
var f={getter:null,setter:null};if(e===d.propertyInterceptModes.DEFINESETTER){f.setter=this.obj.__lookupSetter__(a);f.getter=this.obj.__lookupGetter__(a)}else try{var g=Object.getOwnPropertyDescriptor(this.obj,a);f.setter=g.get;f.getter=g.set}catch(h){}if(!this.overrides)this.overrides={};g=this.overrides[a];if(!g){this.overrides[a]={original:f};g=this.overrides[a]}g.current={getter:c,setter:b};b.overriden=f.setter;c.overriden=f.getter;if(e===d.propertyInterceptModes.DEFINESETTER){if(b)try{this.obj.__defineSetter__(a,
b)}catch(i){console&&console.log&&console.log("Object.__defineSetter__ for property '"+a+"' failed: "+i)}if(c)try{this.obj.__defineGetter__(a,c)}catch(k){console&&console.log&&console.log("Object.__defineGetter__ for property '"+a+"' failed: "+k)}}else if(e===d.propertyInterceptModes.DEFINEPROPERTY||e===d.propertyInterceptModes.DEFINEPROPERTYONLYDOM&&d.isDOMObject(this.obj))try{e={};if(b)e.set=b;if(c)e.get=c;Object.defineProperty(this.obj,a,e)}catch(n){console&&console.log&&console.log("Object.defineProperty for property '"+
a+"' failed: "+n)}return this};d.OQHelper.prototype.unoverrideProperty=function(a){var b=d.propertyInterceptMode();if(b===d.propertyInterceptModes.UNKNOWN||b===d.propertyInterceptModes.NONE)return this;if(!this.overrides)return this;var c=this.overrides[a];if(!c)return this;if(b===d.propertyInterceptModes.DEFINESETTER){if(c.original.setter)try{this.obj.__defineSetter__(a,c.original.setter)}catch(e){tent.log.warn("Object.__defineSetter__ for property '"+a+"' failed: "+e)}if(c.original.getter)try{this.obj.__defineGetter__(a,
c.original.getter)}catch(f){tent.log.warn("Object.__defineGetter__ for property '"+a+"' failed: "+f)}}else if(b===d.propertyInterceptModes.DEFINEPROPERTY||b===d.propertyInterceptModes.DEFINEPROPERTYONLYDOM&&d.isDOMObject(this.obj))try{b={};if(c.original.setter)b.set=c.original.setter;if(c.original.getter)b.get=c.original.getter;Object.defineProperty(this.obj,a,b)}catch(g){tent.log.warn("Object.defineProperty for property '"+a+"' failed: "+g)}delete this.overrides[a];return this};d.OQHelper.prototype.interceptProperties=
function(){if(typeof this.obj!="object")return this;if(this._propertiesIntercepted)return this;this._propertiesIntercepted=true;for(var a in this.obj)d.propertyFilter(this.obj,a)&&this.interceptProperty(this.obj,a)};d.OQHelper.prototype.interceptProperty=function(a,b){(a.__$o__.storage||(a.__$o__.storage={}))[b]=a[b];a.__$o__.overrideProperty(b,function(c){if(this.__$o__){var e=this.__$o__.storage||(this.__$o__.storage={});if(e[b]!==c){var f=e[b];this.__$o__.trigger((new d.Event("propertyChanging")).extend({property:b,
previousValue:f,value:c}));e[b]=c;this.__$o__.trigger((new d.Event("propertyChanged")).extend({property:b,previousValue:f,value:c})).trigger((new d.Event("change")).extend({property:b,previousValue:f,value:c}))}}else this[b]=c},function(){return!this.__$o__||!this.__$o__.storage?this[b]:this.__$o__.storage[b]})};d.OQHelper.prototype.lookup=function(){if(typeof this.obj!="object")return this;if(this._propertiesIntercepted&&!(this.obj instanceof Array))for(var a in this.obj)if(d.propertyFilter(this.obj,
a)&&!this.overrides[a]){this.interceptProperty(this.obj,a);this.trigger((new d.Event("propertyChanging")).extend({property:a,value:this.obj[a]})).trigger((new d.Event("propertyChanged")).extend({property:a,value:this.obj[a]})).trigger((new d.Event("change")).extend({property:a,value:this.obj[a]}))}if(this._arrayModifiersIntercepted&&this.obj instanceof Array)if(this.arrayLength!==this.obj.length){this.arrayLength=this.obj.length;this.trigger((new d.Event("removing")).extend({undetectedLengthChange:true,
index:-1})).trigger((new d.Event("adding")).extend({undetectedLengthChange:true,index:-1})).trigger((new d.Event("removed")).extend({undetectedLengthChange:true,index:-1})).trigger((new d.Event("added")).extend({undetectedLengthChange:true,index:-1})).trigger((new d.Event("change")).extend({undetectedLengthChange:true,index:-1}))}return this};d.OQHelper.prototype.interceptArrayModifiers=function(){if(!this.obj instanceof Array)return this;if(this._arrayModifiersIntercepted)return this;this._arrayModifiersIntercepted=
true;this.obj._length=function(a){if(typeof a=="undefined")return this.length;if(this.length>a)this.splice(a,this.length-a);else this.length=a};this.override("push",function(){if(!this.__$o__||!this.__$o__.events)return Array.prototype.push.apply(this,arguments);var a=this.length,b=Array.prototype.slice.call(arguments);this.__$o__.trigger((new d.Event("adding")).extend({addItems:b,index:a}));var c=Array.prototype.push.apply(this,arguments);this.__$o__.arrayLength=this.length;this.__$o__.trigger((new d.Event("added")).extend({addItems:b,
index:a})).trigger((new d.Event("change")).extend({addItems:b,index:a}));return c});this.override("unshift",function(){if(!this.__$o__||!this.__$o__.events)return Array.prototype.unshift.apply(this,arguments);var a=Array.prototype.slice.call(arguments);this.__$o__.trigger((new d.Event("adding")).extend({addItems:a,index:0}));var b=Array.prototype.unshift.apply(this,arguments);this.__$o__.arrayLength=this.length;this.__$o__.trigger((new d.Event("added")).extend({addItems:a,index:0})).trigger((new d.Event("change")).extend({addItems:a,
index:0}));return b});this.override("pop",function(){if(!this.__$o__||!this.__$o__.events)return Array.prototype.pop.apply(this);var a=this.length-1;this.__$o__.trigger((new d.Event("removing")).extend({removeItems:[this[a]],index:a}));var b=Array.prototype.pop.apply(this);this.__$o__.arrayLength=this.length;this.__$o__.trigger((new d.Event("removed")).extend({removeItems:[b],index:a})).trigger((new d.Event("change")).extend({removeItems:[b],index:a}));return b});this.override("shift",function(){if(!this.__$o__||
!this.__$o__.events)return Array.prototype.shift.apply(this);this.__$o__.trigger((new d.Event("removing")).extend({removeItems:[this[0]],index:index}));var a=Array.prototype.shift.apply(this);this.__$o__.arrayLength=this.length;this.__$o__.trigger((new d.Event("removed")).extend({removeItems:[a],index:0})).trigger((new d.Event("change")).extend({removeItems:[a],index:0}));return a});this.override("splice",function(a,b){if(!this.__$o__||!this.__$o__.events)return Array.prototype.splice.apply(this,
arguments);var c;b&&b>0&&this.__$o__.trigger((new d.Event("removing")).extend({removeItems:this.slice(a,a+b),index:a}));if(arguments.length>2){c=Array.prototype.slice.call(arguments,2);this.__$o__.trigger((new d.Event("adding")).extend({addItems:c,index:a}))}if(c&&c.length>0){var e=c.slice(0);e.unshift(a,b);e=Array.prototype.splice.apply(this,e)}else e=Array.prototype.splice(a,b);this.__$o__.arrayLength=this.length;e&&e.length>0&&this.__$o__.trigger((new d.Event("removed")).extend({removeItems:e,
index:a}));arguments.length>2&&this.__$o__.trigger((new d.Event("added")).extend({addItems:c,index:a}));this.__$o__.trigger((new d.Event("change")).extend({removeItems:e,addItems:c,index:a}));return e});this.arrayLength=this.obj.length};d.OQHelper.prototype.prop=function(a,b){var c=this.overrides[a];if(typeof b=="undefined"&&typeof a=="string")return c&&c.current.getter?c.current.getter.call(this.obj,a):this.obj[a];else{if(a==="length"&&this.obj instanceof Array)if(this.obj.length>b)this.obj.splice(b,
this.obj.length-l);else this.length=b;else if(typeof a=="object")for(var e in a){var f=a[e];if(typeof f=="function")f=f.apply(this.obj);if(c&&c.current.setter)c.current.setter.call(this.obj,f);else this.obj[e]=f}else if(c&&c.current.setter)c.current.setter.call(this.obj,b);else this.obj[a]=b;return this}};d.OQArray=function(){this._array=Array.prototype.slice.apply(arguments)};d.OQArray.prototype.get=function(a){return typeof a!="number"?this._array:a>=0?this._array[a]:this._array[this._array.length+
a]};d.OQArray.prototype.add=function(){var a=Array.prototype.slice.apply(this._array);a.push.apply(a,arguments);return d.a(a)};d.OQArray.prototype.adda=function(){var a;if(arguments.length==1&&arguments[0]instanceof Array)a=arguments[0];else{a=[];for(var b=0;b<arguments.length;b++)arguments[b]instanceof Array&&a.push.apply(a,arguments[b])}b=Array.prototype.slice.apply(this._array);b.push.apply(b,a);return d.a(b)};d.OQArray.prototype.index=function(a){for(var b=0,c=this._array.length;b<c;b++)if(this._array[b]===
a)return b;return-1};d.OQArray.prototype.deep=function(){for(var a=d(),b=function(e){if(typeof e=="object")if(a.index(e)<0){a._array.push(e);if(typeof e=="object"){for(var f in e)if(!f.substr(0,1)==="_"){var g=e[f];b(g)}if(e instanceof Array){f=0;for(var h=e.length;f<h;f++){g=e[f];b(g)}}}}},c=0;c<this._array.length;c++)b(this._array[c]);return a};d.OQArray.prototype.each=function(a){for(var b=0;b<this._array.length;b++)a.apply(this._array[b]);return this};d.OQArray.prototype.filter=function(a){for(var b=
[],c=0;c<this._array.length;c++)a.apply(this._array[c])&&b.push(this._array(c));return d.a(b)};d.OQArray.prototype.change=function(){var a=Array.prototype.slice.call(arguments);a.unshift("change");return this.bind.apply(this,a)};d.OQArray.prototype.bind=function(){for(var a=0,b=this._array.length;a<b;a++){var c=this._array[a];c=c.__$o__||(c.__$o__=new d.OQHelper(c));c.bind.apply(c,arguments)}return this};d.OQArray.prototype.unbind=function(){for(var a=0,b=this._array.length;a<b;a++){var c=this._array[a].__$o__;
c&&c.unbind.apply(c,arguments)}return this};d.OQArray.prototype.trigger=function(){for(var a=0,b=this._array.length;a<b;a++){var c=this._array[a].__$o__;c&&c.trigger.apply(c,arguments)}return this};d.OQArray.prototype.lookup=function(){for(var a=0,b=this._array.length;a<b;a++){var c=this._array[a].__$o__;c&&c.lookup.apply(c,arguments)}return this};d.OQArray.prototype.prop=function(a,b){for(var c,e=typeof b=="undefined"&&typeof a=="string",f=0,g=this._array.length;f<g;f++){var h=this._array[f],i=h.__$o__;
if(i)c=i.prop(a,b);else if(e)c=h[a];else h[a]=b}return e?c:this}})(window||exports||{});
